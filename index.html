<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OpenHabits ‚Äì Level Up Your Life</title>
  <meta name="description" content="Open source offline-first gamified habit tracker" />
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0d1117" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="layout">
    <aside class="sidebar" aria-label="Primary">
      <div class="brand">
        <a href="https://pgraycs.github.io/openhabits/" class="logo-link" title="Project homepage">
          <span class="logo-icon" aria-hidden="true">‚õ∞Ô∏è</span>
          <span class="logo-text">OpenHabits</span>
        </a>
        <span class="tag beta">ALPHA</span>
      </div>
      <div class="level-block">
        <div class="level-ring" aria-label="Level progress">
          <svg viewBox="0 0 120 120" class="ring" role="img" aria-hidden="true">
            <circle cx="60" cy="60" r="52" class="track" />
            <circle cx="60" cy="60" r="52" class="progress" id="level-progress-ring" />
          </svg>
          <div class="level-center">
            <div class="lvl-label">Lvl</div>
            <div class="lvl-value" id="level">1</div>
          </div>
        </div>
        <div class="xp-nums" id="xp-display"><span id="xp">0</span> XP ‚Ä¢ <span id="level-progress-label"></span></div>
      </div>
      <nav class="nav">
        <button id="btn-add-habit" class="primary" title="Add Habit">+ Habit</button>
        <button id="btn-stats" title="Toggle Stats">Stats</button>
        <button id="btn-achievements" title="Toggle Achievements">Achievements</button>
        <button id="btn-export" title="Export data">Export</button>
        <label class="import-label" title="Import backup">Import<input type="file" id="import-file" accept="application/json" /></label>
        <button id="btn-theme" title="Toggle theme">üåô</button>
      </nav>
      <div class="streaks-box" id="streaks-summary" aria-label="Top streaks"></div>
      <div class="sidebar-footer">
        <small>Offline ‚Ä¢ Private ‚Ä¢ Open Source</small>
      </div>
    </aside>
    <div class="content" id="main">
      <header class="topbar">
        <div class="top-info">
          <h1 class="visually-hidden">OpenHabits Dashboard</h1>
          <div class="date" id="today-date"></div>
        </div>
      </header>
      <div class="panels-grid">
        <section class="panel" id="daily-quests-panel">
          <h2>Daily Quests <span id="daily-xp"></span></h2>
          <div id="daily-quests" class="habit-grid empty-msg">Loading‚Ä¶</div>
        </section>
        <section class="panel" id="habits-panel">
          <h2>Your Habits</h2>
          <div id="habits" class="habit-grid empty-msg">No habits yet ‚Äì press + Habit to start!</div>
        </section>
        <section class="panel" id="stats-panel" hidden>
          <h2>Stats</h2>
          <div id="stats-content"></div>
        </section>
        <section class="panel" id="achievements-panel" hidden>
          <h2>Achievements</h2>
          <div id="achievements-content"></div>
        </section>
      </div>
      <footer class="app-footer">
        <span>Built with ‚ù§Ô∏è for self‚Äëimprovement</span>
        <span class="foot-links"><a href="https://github.com/PGrayCS/openhabits" target="_blank" rel="noopener">GitHub</a></span>
      </footer>
    </div>
  </div>

  <dialog id="habit-dialog">
    <form method="dialog" id="habit-form">
      <h3 id="habit-dialog-title">New Habit</h3>
      <label>Name <input name="name" required maxlength="60" /></label>
      <label>Description <textarea name="description" maxlength="240"></textarea></label>
      <fieldset>
        <legend>Schedule</legend>
        <label><input type="checkbox" name="days" value="0" checked />Sun</label>
        <label><input type="checkbox" name="days" value="1" checked />Mon</label>
        <label><input type="checkbox" name="days" value="2" checked />Tue</label>
        <label><input type="checkbox" name="days" value="3" checked />Wed</label>
        <label><input type="checkbox" name="days" value="4" checked />Thu</label>
        <label><input type="checkbox" name="days" value="5" checked />Fri</label>
        <label><input type="checkbox" name="days" value="6" checked />Sat</label>
      </fieldset>
      <label>Target / Day <input type="number" name="target" min="1" max="20" value="1" /></label>
      <fieldset>
        <legend>Schedule Mode</legend>
        <label><input type="radio" name="scheduleType" value="daysOfWeek" checked /> Days of Week</label>
        <label><input type="radio" name="scheduleType" value="timesPerWeek" /> Times / Week</label>
      </fieldset>
      <label data-schedule="timesPerWeek" hidden>Times per Week <input type="number" name="timesPerWeek" min="1" max="7" value="3" /></label>
      <menu>
        <button value="cancel">Cancel</button>
        <button value="ok" class="primary">Save</button>
      </menu>
    </form>
  </dialog>

  <dialog id="toast" class="toast"></dialog>
  <canvas id="confetti" aria-hidden="true"></canvas>
  <script type="module" src="src/app.js"></script>
  <script>
    // Toggle schedule fields (days vs times per week)
    window.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('habit-form');
      if(!form) return;
      const modeRadios = form.querySelectorAll('input[name="scheduleType"]');
      const dayFieldset = form.querySelectorAll('fieldset')[0];
      const tpwLabel = form.querySelector('[data-schedule="timesPerWeek"]');
      function update(){
        const val = form.querySelector('input[name="scheduleType"]:checked')?.value;
        if(val === 'timesPerWeek'){
          dayFieldset.hidden = true;
          tpwLabel.hidden = false;
        } else {
          dayFieldset.hidden = false;
          tpwLabel.hidden = true;
        }
      }
      modeRadios.forEach(r=> r.addEventListener('change', update));
      update();
    });
  </script>
</body>
</html>