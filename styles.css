* { box-sizing: border-box; }
html { --font-stack: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif; }
body { margin:0; padding:0; font-family: var(--font-stack); min-height:100vh; display:flex; flex-direction:column; background:var(--bg-gradient); color:var(--text-primary); -webkit-font-smoothing:antialiased; }

:root { --c-bg:#0d1117; --c-bg-alt:#161b22; --c-panel:#1d2631; --c-panel-glass:rgba(29,38,49,.78); --c-border:#2d3a45; --c-border-strong:#3d4a56; --c-accent:#5d8bff; --c-accent-glow:#5d8bff55; --c-accent-gradient:linear-gradient(135deg,#5d8bff,#9b59ff 70%); --c-success:#238636; --c-success-glow:#23863655; --c-text:#f0f6fc; --c-text-dim:#9aa4af; --shadow-lg:0 4px 18px -4px #000a,0 2px 4px -2px #0008; --radius:16px; --trans:150ms cubic-bezier(.4,.2,.2,1); --bg-gradient:radial-gradient(circle at 20% 15%,#1d2732,#0d1117 60%); }
body.light { --c-bg:#f5f7fb; --c-bg-alt:#eef1f6; --c-panel:#ffffff; --c-panel-glass:rgba(255,255,255,.7); --c-border:#d0d7e2; --c-border-strong:#b5bdc9; --c-text:#1b2734; --c-text-dim:#5c6875; --bg-gradient:radial-gradient(circle at 25% 20%,#ffffff,#d9e3ee 70%); --c-accent:#2563eb; --c-accent-glow:#2563eb55; --c-accent-gradient:linear-gradient(135deg,#2563eb,#7f5dff); }

header.app-header { display:flex; gap:1rem; flex-wrap:wrap; align-items:center; padding:.85rem 1.2rem; background:linear-gradient(95deg,var(--c-bg-alt),var(--c-panel)); border-bottom:1px solid var(--c-border); position:sticky; top:0; z-index:20; backdrop-filter:blur(10px); }
header h1 { font-size:1.25rem; margin:0; font-weight:600; letter-spacing:.5px; display:flex; align-items:center; gap:.55rem; }
.app-header h1 a { color:inherit; text-decoration:none; }
.app-header h1 a:hover { text-decoration:underline; }
.beta-tag { background:var(--c-accent-gradient); color:#fff; padding:2px 8px; border-radius:999px; font-size:.6rem; letter-spacing:.5px; box-shadow:0 0 0 1px #ffffff22; }
nav { display:flex; gap:.55rem; flex-wrap:wrap; }
nav button, dialog button, .import-label { --btn-bg:var(--c-panel); --btn-border:var(--c-border); background:linear-gradient(var(--btn-bg),var(--c-panel)); color:var(--c-text); border:1px solid var(--btn-border); padding:.55rem .9rem .5rem; border-radius:10px; cursor:pointer; font-weight:500; font-size:.8rem; line-height:1; position:relative; transition:var(--trans); }
nav button.primary, dialog button.primary { --btn-bg:linear-gradient(135deg,var(--c-accent),#7f5dff); color:#fff; border-color:transparent; box-shadow:0 2px 10px -2px var(--c-accent-glow); }
nav button:hover, dialog button:hover, .import-label:hover { filter:brightness(1.15); box-shadow:0 2px 10px -2px #0005; }
nav button:active { transform:translateY(2px); }
label.import-label { position:relative; overflow:hidden; display:inline-flex; align-items:center; }
label.import-label input { position:absolute; inset:0; opacity:0; cursor:pointer; }

main { flex:1; width:min(1250px,100%); margin:0 auto; padding:1.1rem 1.1rem 2rem; display:grid; gap:1.15rem; grid-template-columns:repeat(auto-fit,minmax(340px,1fr)); }
.panel { background:var(--c-panel-glass); backdrop-filter:blur(14px) saturate(1.4); padding:1.1rem 1.2rem 1.35rem; border:1px solid var(--c-border); border-radius:var(--radius); display:flex; flex-direction:column; gap:.85rem; position:relative; box-shadow:var(--shadow-lg); overflow:hidden; }
.panel:before { content:""; position:absolute; inset:0; background:linear-gradient(135deg,rgba(255,255,255,.04),transparent 60%); pointer-events:none; }
.panel h2 { margin:0; font-size:1.05rem; letter-spacing:.5px; font-weight:600; display:flex; align-items:center; gap:.5rem; }
.habit-grid { display:grid; gap:.75rem; grid-template-columns:repeat(auto-fill,minmax(190px,1fr)); }
.habit-card { --progress:0%; background:linear-gradient(145deg,var(--c-panel) 0%,var(--c-bg-alt) 110%); padding:.85rem .75rem .95rem; border:1px solid var(--c-border); border-radius:14px; position:relative; display:flex; flex-direction:column; gap:.45rem; transition:var(--trans); overflow:hidden; }
.habit-card:before { content:""; position:absolute; inset:0; background:linear-gradient(135deg,rgba(255,255,255,.04),transparent 60%); opacity:0; transition:var(--trans); }
.habit-card:hover:before { opacity:1; }
.habit-card.completed-today { border-color:var(--c-success); box-shadow:0 0 0 1px var(--c-success-glow),0 6px 18px -8px var(--c-success-glow); }
.habit-card h3 { margin:0; font-size:.95rem; font-weight:600; line-height:1.25; letter-spacing:.3px; }
.habit-card .desc { font-size:.65rem; opacity:.65; min-height:1.2em; letter-spacing:.3px; }
.habit-actions { display:flex; gap:.5rem; flex-wrap:wrap; margin-top:auto; }
.habit-actions button { flex:1; font-size:.65rem; padding:.45rem .4rem .4rem; background:var(--c-bg-alt); border:1px solid var(--c-border); border-radius:8px; cursor:pointer; letter-spacing:.5px; font-weight:600; transition:var(--trans); }
.habit-actions button.do { background:var(--c-accent-gradient); border-color:transparent; color:#fff; box-shadow:0 2px 8px -2px var(--c-accent-glow); }
.habit-actions button:hover { filter:brightness(1.1); }
.habit-actions button.do:active { transform:scale(.95); }
.streak { font-size:.6rem; opacity:.75; display:flex; align-items:center; gap:.25rem; letter-spacing:.4px; }
.progress-bar { position:relative; height:6px; background:linear-gradient(90deg,#ffffff08,#ffffff10); border-radius:4px; overflow:hidden; margin-top:.15rem; }
.progress-bar span { position:absolute; inset:0; width:var(--progress); background:var(--c-accent-gradient); box-shadow:0 0 0 1px #ffffff11,0 0 12px -2px var(--c-accent-glow); transition:width .4s var(--trans); }
.achievement { background:linear-gradient(145deg,var(--c-panel) 0%,var(--c-bg-alt) 120%); border:1px solid var(--c-border); padding:.7rem .8rem .75rem; border-radius:14px; font-size:.7rem; display:flex; flex-direction:column; gap:.35rem; position:relative; box-shadow:0 2px 6px -2px #0007; }
.achievement.unlocked { border-color:#9b59b6; box-shadow:0 0 0 1px #9b59b655,0 4px 15px -6px #9b59b633; }
.achievement .title { font-weight:600; font-size:.75rem; letter-spacing:.4px; }
.achievement .reward { font-size:.55rem; opacity:.6; }
.achievement .date { position:absolute; top:.45rem; right:.6rem; font-size:.55rem; opacity:.45; }

footer { display:flex; justify-content:space-between; align-items:flex-start; gap:1.2rem; padding:.8rem 1.2rem 1.1rem; background:linear-gradient(95deg,var(--c-bg-alt),var(--c-panel)); border-top:1px solid var(--c-border); flex-wrap:wrap; font-size:.72rem; backdrop-filter:blur(12px); }
.footer-left { display:flex; flex-direction:column; gap:.4rem; min-width:200px; }
#xp-display { font-weight:600; letter-spacing:.5px; }
.level-progress { display:flex; flex-direction:column; gap:.25rem; width:220px; }
.level-progress .bar { position:relative; height:8px; background:#ffffff10; border-radius:5px; overflow:hidden; }
.level-progress .bar span { position:absolute; inset:0; width:0%; background:var(--c-accent-gradient); box-shadow:0 0 0 1px #ffffff22,0 0 14px -4px var(--c-accent-glow); transition:width .55s var(--trans); }
.level-progress .lp-label { font-size:.55rem; letter-spacing:.6px; text-transform:uppercase; opacity:.6; }
#streaks-summary { display:flex; gap:.55rem; flex-wrap:wrap; max-width:600px; }

dialog { border:1px solid var(--c-border-strong); background:var(--c-panel); color:var(--c-text); border-radius:24px; padding:1.15rem 1.25rem 1.35rem; width:min(480px,90vw); box-shadow:var(--shadow-lg); }
dialog form { display:flex; flex-direction:column; gap:.85rem; }
dialog input, dialog textarea { width:100%; background:var(--c-bg-alt); border:1px solid var(--c-border); color:var(--c-text); padding:.65rem .7rem; border-radius:10px; font:inherit; resize:vertical; }
dialog input:focus, dialog textarea:focus { outline:2px solid var(--c-accent); outline-offset:2px; }
fieldset { border:1px solid var(--c-border); border-radius:14px; padding:.55rem .75rem .7rem; display:flex; flex-wrap:wrap; gap:.45rem; }
fieldset label { font-size:.6rem; display:flex; align-items:center; gap:.25rem; background:var(--c-bg-alt); padding:.3rem .55rem; border-radius:8px; letter-spacing:.4px; }
fieldset input { width:auto; }
.empty-msg { opacity:.55; font-size:.75rem; letter-spacing:.5px; }
.toast { border:none; background:var(--c-accent-gradient); color:#fff; padding:.65rem 1rem .7rem; border-radius:14px; font-size:.75rem; animation:fadeSlide .5s ease; box-shadow:0 4px 16px -6px var(--c-accent-glow); }
@keyframes fadeSlide { from { opacity:0; transform:translateY(6px);} to { opacity:1; transform:translateY(0);} }
#confetti { position:fixed; inset:0; width:100%; height:100%; pointer-events:none; z-index:50; }

::-webkit-scrollbar { width:10px; height:10px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:#ffffff1f; border-radius:20px; }
::-webkit-scrollbar-thumb:hover { background:#ffffff33; }

@media (max-width:700px){
  main { grid-template-columns:1fr; }
  .habit-grid { grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); }
  .level-progress { width:100%; }
}